



<!doctype html>
<html lang="zh" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
      
      
      
        <meta name="lang:clipboard.copy" content="复制">
      
        <meta name="lang:clipboard.copied" content="已复制">
      
        <meta name="lang:search.language" content="jp">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="没有找到符合条件的结果">
      
        <meta name="lang:search.result.one" content="找到 1 个符合条件的结果">
      
        <meta name="lang:search.result.other" content="# 个符合条件的结果">
      
        <meta name="lang:search.tokenizer" content="[\uff0c\u3002]+">
      
      <link rel="shortcut icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.0.4, mkdocs-material-4.0.1">
    
    
      
        <title>Supervisor - 技术文档整理归纳</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/application.982221ab.css">
      
      
    
    
      <script src="../../assets/javascripts/modernizr.1f0bcf2b.js"></script>
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
    
    <link rel="stylesheet" href="../../assets/fonts/material-icons.css">
    
    
    
      
    
    
  </head>
  
    <body dir="ltr">
  
    <svg class="md-svg">
      <defs>
        
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
      <a href="#supervisor" tabindex="1" class="md-skip">
        跳转至
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="../.." title="技术文档整理归纳" class="md-header-nav__button md-logo">
          
            <i class="md-icon"></i>
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            <span class="md-header-nav__topic">
              技术文档整理归纳
            </span>
            <span class="md-header-nav__topic">
              Supervisor
            </span>
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
          
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="搜索" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            键入以开始搜索
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
        
      </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="../.." title="技术文档整理归纳" class="md-nav__button md-logo">
      
        <i class="md-icon"></i>
      
    </a>
    技术文档整理归纳
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href="../.." title="Home" class="md-nav__link">
      Home
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../docker_0/" title="Docker" class="md-nav__link">
      Docker
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3">
    
    <label class="md-nav__link" for="nav-3">
      Bash
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        Bash
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../bash/prompt/" title="Prompt" class="md-nav__link">
      Prompt
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4">
    
    <label class="md-nav__link" for="nav-4">
      Python
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        Python
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../.." title="todo" class="md-nav__link">
      todo
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../python/decorator/" title="Decorator" class="md-nav__link">
      Decorator
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../python/strange_traps_in_python/" title="Python里面奇怪的坑" class="md-nav__link">
      Python里面奇怪的坑
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../python/gc/" title="垃圾回收GC" class="md-nav__link">
      垃圾回收GC
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-5" type="checkbox" id="nav-5">
    
    <label class="md-nav__link" for="nav-5">
      进程管理工具
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-5">
        进程管理工具
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../" title="Supervisor" class="md-nav__link">
      Supervisor
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../mkdocs/" title="MkDocs" class="md-nav__link">
      MkDocs
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../tmux/" title="Tmux" class="md-nav__link">
      Tmux
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-8" type="checkbox" id="nav-8">
    
    <label class="md-nav__link" for="nav-8">
      笔记（未整理）
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-8">
        笔记（未整理）
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../mysql/" title="MySQL" class="md-nav__link">
      MySQL
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../redis/" title="Redis" class="md-nav__link">
      Redis
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../coroutine/" title="进程/线程/协程" class="md-nav__link">
      进程/线程/协程
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../dcs/" title="分布式设计" class="md-nav__link">
      分布式设计
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tcp/" title="tcp/udp/kcp" class="md-nav__link">
      tcp/udp/kcp
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../msgpack/" title="二进制编码" class="md-nav__link">
      二进制编码
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../cpp/" title="C++" class="md-nav__link">
      C++
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../misc/" title="未分类" class="md-nav__link">
      未分类
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">目录</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#configuration-template" title="Configuration Template 配置文件的模版" class="md-nav__link">
    Configuration Template 配置文件的模版
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#details" title="Details 配置文件详解" class="md-nav__link">
    Details 配置文件详解
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#section-unix_http_server" title="Section: unix_http_server" class="md-nav__link">
    Section: unix_http_server
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#section-inet_http_server" title="Section: inet_http_server" class="md-nav__link">
    Section: inet_http_server
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#section-supervisord" title="Section: supervisord" class="md-nav__link">
    Section: supervisord
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#section-rpcinterface" title="Section: rpcinterface" class="md-nav__link">
    Section: rpcinterface
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#section-supervisorctl" title="Section: supervisorctl" class="md-nav__link">
    Section: supervisorctl
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#section-program" title="Section: program" class="md-nav__link">
    Section: program
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#section-eventlistener" title="Section: eventlistener" class="md-nav__link">
    Section: eventlistener
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#section-group" title="Section: group" class="md-nav__link">
    Section: group
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#section-include" title="Section: include" class="md-nav__link">
    Section: include
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#supervisord" title="supervisord" class="md-nav__link">
    supervisord
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#supervisorctl" title="supervisorctl" class="md-nav__link">
    supervisorctl
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                
                <h1 id="supervisor">Supervisor<a class="headerlink" href="#supervisor" title="Permanent link">&para;</a></h1>
<h2 id="configuration-template">Configuration Template 配置文件的模版<a class="headerlink" href="#configuration-template" title="Permanent link">&para;</a></h2>
<p>运行echo_supervisord_conf打印出一个配置文件的样本。<br/></p>
<blockquote>
<p>echo_supervisord_conf</p>
</blockquote>
<div class="codehilite"><pre><span></span><span class="c1">; Sample supervisor config file.</span>
<span class="c1">;</span>
<span class="c1">; For more information on the config file, please see:</span>
<span class="c1">; http://supervisord.org/configuration.html</span>
<span class="c1">;</span>
<span class="c1">; Notes:</span>
<span class="c1">;  - Shell expansion (&quot;~&quot; or &quot;$HOME&quot;) is not supported.  Environment</span>
<span class="c1">;    variables can be expanded using this syntax: &quot;%(ENV_HOME)s&quot;.</span>
<span class="c1">;  - Quotes around values are not supported, except in the case of</span>
<span class="c1">;    the environment= options as shown below.</span>
<span class="c1">;  - Comments must have a leading space: &quot;a=b ;comment&quot; not &quot;a=b;comment&quot;.</span>
<span class="c1">;  - Command will be truncated if it looks like a config file comment, e.g.</span>
<span class="c1">;    &quot;command=bash -c &#39;foo ; bar&#39;&quot; will truncate to &quot;command=bash -c &#39;foo &quot;.</span>

<span class="k">[unix_http_server]</span>
<span class="na">file</span><span class="o">=</span><span class="s">/usr/local/var/run/supervisor.sock   ; the path to the socket file</span>
<span class="c1">;chmod=0700                 ; socket file mode (default 0700)</span>
<span class="c1">;chown=nobody:nogroup       ; socket file uid:gid owner</span>
<span class="c1">;username=user              ; default is no username (open server)</span>
<span class="c1">;password=123               ; default is no password (open server)</span>

<span class="c1">;[inet_http_server]         ; inet (TCP) server disabled by default</span>
<span class="c1">;port=127.0.0.1:9001        ; ip_address:port specifier, *:port for all iface</span>
<span class="c1">;username=user              ; default is no username (open server)</span>
<span class="c1">;password=123               ; default is no password (open server)</span>

<span class="k">[supervisord]</span>
<span class="na">logfile</span><span class="o">=</span><span class="s">/usr/local/var/log/supervisord.log ; main log file; default $CWD/supervisord.log</span>
<span class="na">logfile_maxbytes</span><span class="o">=</span><span class="s">50MB        ; max main logfile bytes b4 rotation; default 50MB</span>
<span class="na">logfile_backups</span><span class="o">=</span><span class="s">10           ; # of main logfile backups; 0 means none, default 10</span>
<span class="na">loglevel</span><span class="o">=</span><span class="s">info                ; log level; default info; others: debug,warn,trace</span>
<span class="na">pidfile</span><span class="o">=</span><span class="s">/usr/local/var/run/supervisord.pid ; supervisord pidfile; default supervisord.pid</span>
<span class="na">nodaemon</span><span class="o">=</span><span class="s">false               ; start in foreground if true; default false</span>
<span class="na">minfds</span><span class="o">=</span><span class="s">1024                  ; min. avail startup file descriptors; default 1024</span>
<span class="na">minprocs</span><span class="o">=</span><span class="s">200                 ; min. avail process descriptors;default 200</span>
<span class="c1">;umask=022                   ; process file creation umask; default 022</span>
<span class="c1">;user=chrism                 ; default is current user, required if root</span>
<span class="c1">;identifier=supervisor       ; supervisord identifier, default is &#39;supervisor&#39;</span>
<span class="c1">;directory=/tmp              ; default is not to cd during start</span>
<span class="c1">;nocleanup=true              ; don&#39;t clean up tempfiles at start; default false</span>
<span class="c1">;childlogdir=/tmp            ; &#39;AUTO&#39; child log dir, default $TEMP</span>
<span class="c1">;environment=KEY=&quot;value&quot;     ; key value pairs to add to environment</span>
<span class="c1">;strip_ansi=false            ; strip ansi escape codes in logs; def. false</span>

<span class="c1">; The rpcinterface:supervisor section must remain in the config file for</span>
<span class="c1">; RPC (supervisorctl/web interface) to work.  Additional interfaces may be</span>
<span class="c1">; added by defining them in separate [rpcinterface:x] sections.</span>

<span class="k">[rpcinterface:supervisor]</span>
<span class="na">supervisor.rpcinterface_factory</span> <span class="o">=</span> <span class="s">supervisor.rpcinterface:make_main_rpcinterface</span>

<span class="c1">; The supervisorctl section configures how supervisorctl will connect to</span>
<span class="c1">; supervisord.  configure it match the settings in either the unix_http_server</span>
<span class="c1">; or inet_http_server section.</span>

<span class="k">[supervisorctl]</span>
<span class="na">serverurl</span><span class="o">=</span><span class="s">unix:///usr/local/var/run/supervisor.sock ; use a unix:// URL  for a unix socket</span>
<span class="c1">;serverurl=http://127.0.0.1:9001 ; use an http:// url to specify an inet socket</span>
<span class="c1">;username=chris              ; should be same as in [*_http_server] if set</span>
<span class="c1">;password=123                ; should be same as in [*_http_server] if set</span>
<span class="c1">;prompt=mysupervisor         ; cmd line prompt (default &quot;supervisor&quot;)</span>
<span class="c1">;history_file=~/.sc_history  ; use readline history if available</span>

<span class="c1">; The sample program section below shows all possible program subsection values.</span>
<span class="c1">; Create one or more &#39;real&#39; program: sections to be able to control them under</span>
<span class="c1">; supervisor.</span>

<span class="c1">;[program:theprogramname]</span>
<span class="c1">;command=/bin/cat              ; the program (relative uses PATH, can take args)</span>
<span class="c1">;process_name=%(program_name)s ; process_name expr (default %(program_name)s)</span>
<span class="c1">;numprocs=1                    ; number of processes copies to start (def 1)</span>
<span class="c1">;directory=/tmp                ; directory to cwd to before exec (def no cwd)</span>
<span class="c1">;umask=022                     ; umask for process (default None)</span>
<span class="c1">;priority=999                  ; the relative start priority (default 999)</span>
<span class="c1">;autostart=true                ; start at supervisord start (default: true)</span>
<span class="c1">;startsecs=1                   ; # of secs prog must stay up to be running (def. 1)</span>
<span class="c1">;startretries=3                ; max # of serial start failures when starting (default 3)</span>
<span class="c1">;autorestart=unexpected        ; when to restart if exited after running (def: unexpected)</span>
<span class="c1">;exitcodes=0,2                 ; &#39;expected&#39; exit codes used with autorestart (default 0,2)</span>
<span class="c1">;stopsignal=QUIT               ; signal used to kill process (default TERM)</span>
<span class="c1">;stopwaitsecs=10               ; max num secs to wait b4 SIGKILL (default 10)</span>
<span class="c1">;stopasgroup=false             ; send stop signal to the UNIX process group (default false)</span>
<span class="c1">;killasgroup=false             ; SIGKILL the UNIX process group (def false)</span>
<span class="c1">;user=chrism                   ; setuid to this UNIX account to run the program</span>
<span class="c1">;redirect_stderr=true          ; redirect proc stderr to stdout (default false)</span>
<span class="c1">;stdout_logfile=/a/path        ; stdout log path, NONE for none; default AUTO</span>
<span class="c1">;stdout_logfile_maxbytes=1MB   ; max # logfile bytes b4 rotation (default 50MB)</span>
<span class="c1">;stdout_logfile_backups=10     ; # of stdout logfile backups (0 means none, default 10)</span>
<span class="c1">;stdout_capture_maxbytes=1MB   ; number of bytes in &#39;capturemode&#39; (default 0)</span>
<span class="c1">;stdout_events_enabled=false   ; emit events on stdout writes (default false)</span>
<span class="c1">;stderr_logfile=/a/path        ; stderr log path, NONE for none; default AUTO</span>
<span class="c1">;stderr_logfile_maxbytes=1MB   ; max # logfile bytes b4 rotation (default 50MB)</span>
<span class="c1">;stderr_logfile_backups=10     ; # of stderr logfile backups (0 means none, default 10)</span>
<span class="c1">;stderr_capture_maxbytes=1MB   ; number of bytes in &#39;capturemode&#39; (default 0)</span>
<span class="c1">;stderr_events_enabled=false   ; emit events on stderr writes (default false)</span>
<span class="c1">;environment=A=&quot;1&quot;,B=&quot;2&quot;       ; process environment additions (def no adds)</span>
<span class="c1">;serverurl=AUTO                ; override serverurl computation (childutils)</span>

<span class="c1">; The sample eventlistener section below shows all possible eventlistener</span>
<span class="c1">; subsection values.  Create one or more &#39;real&#39; eventlistener: sections to be</span>
<span class="c1">; able to handle event notifications sent by supervisord.</span>

<span class="c1">;[eventlistener:theeventlistenername]</span>
<span class="c1">;command=/bin/eventlistener    ; the program (relative uses PATH, can take args)</span>
<span class="c1">;process_name=%(program_name)s ; process_name expr (default %(program_name)s)</span>
<span class="c1">;numprocs=1                    ; number of processes copies to start (def 1)</span>
<span class="c1">;events=EVENT                  ; event notif. types to subscribe to (req&#39;d)</span>
<span class="c1">;buffer_size=10                ; event buffer queue size (default 10)</span>
<span class="c1">;directory=/tmp                ; directory to cwd to before exec (def no cwd)</span>
<span class="c1">;umask=022                     ; umask for process (default None)</span>
<span class="c1">;priority=-1                   ; the relative start priority (default -1)</span>
<span class="c1">;autostart=true                ; start at supervisord start (default: true)</span>
<span class="c1">;startsecs=1                   ; # of secs prog must stay up to be running (def. 1)</span>
<span class="c1">;startretries=3                ; max # of serial start failures when starting (default 3)</span>
<span class="c1">;autorestart=unexpected        ; autorestart if exited after running (def: unexpected)</span>
<span class="c1">;exitcodes=0,2                 ; &#39;expected&#39; exit codes used with autorestart (default 0,2)</span>
<span class="c1">;stopsignal=QUIT               ; signal used to kill process (default TERM)</span>
<span class="c1">;stopwaitsecs=10               ; max num secs to wait b4 SIGKILL (default 10)</span>
<span class="c1">;stopasgroup=false             ; send stop signal to the UNIX process group (default false)</span>
<span class="c1">;killasgroup=false             ; SIGKILL the UNIX process group (def false)</span>
<span class="c1">;user=chrism                   ; setuid to this UNIX account to run the program</span>
<span class="c1">;redirect_stderr=false         ; redirect_stderr=true is not allowed for eventlisteners</span>
<span class="c1">;stdout_logfile=/a/path        ; stdout log path, NONE for none; default AUTO</span>
<span class="c1">;stdout_logfile_maxbytes=1MB   ; max # logfile bytes b4 rotation (default 50MB)</span>
<span class="c1">;stdout_logfile_backups=10     ; # of stdout logfile backups (0 means none, default 10)</span>
<span class="c1">;stdout_events_enabled=false   ; emit events on stdout writes (default false)</span>
<span class="c1">;stderr_logfile=/a/path        ; stderr log path, NONE for none; default AUTO</span>
<span class="c1">;stderr_logfile_maxbytes=1MB   ; max # logfile bytes b4 rotation (default 50MB)</span>
<span class="c1">;stderr_logfile_backups=10     ; # of stderr logfile backups (0 means none, default 10)</span>
<span class="c1">;stderr_events_enabled=false   ; emit events on stderr writes (default false)</span>
<span class="c1">;environment=A=&quot;1&quot;,B=&quot;2&quot;       ; process environment additions</span>
<span class="c1">;serverurl=AUTO                ; override serverurl computation (childutils)</span>

<span class="c1">; The sample group section below shows all possible group values.  Create one</span>
<span class="c1">; or more &#39;real&#39; group: sections to create &quot;heterogeneous&quot; process groups.</span>

<span class="c1">;[group:thegroupname]</span>
<span class="c1">;programs=progname1,progname2  ; each refers to &#39;x&#39; in [program:x] definitions</span>
<span class="c1">;priority=999                  ; the relative start priority (default 999)</span>

<span class="c1">; The [include] section can just contain the &quot;files&quot; setting.  This</span>
<span class="c1">; setting can list multiple files (separated by whitespace or</span>
<span class="c1">; newlines).  It can also contain wildcards.  The filenames are</span>
<span class="c1">; interpreted as relative to this file.  Included files *cannot*</span>
<span class="c1">; include files themselves.</span>

<span class="k">[include]</span>
<span class="na">files</span> <span class="o">=</span> <span class="s">/usr/local/etc/supervisor.d/*.ini</span>
</pre></div>


<h2 id="details">Details 配置文件详解<a class="headerlink" href="#details" title="Permanent link">&para;</a></h2>
<h3 id="section-unix_http_server">Section: unix_http_server<a class="headerlink" href="#section-unix_http_server" title="Permanent link">&para;</a></h3>
<div class="codehilite"><pre><span></span><span class="cp">[</span><span class="nx">unix_http_server</span><span class="cp">]</span>            
<span class="nt">file</span><span class="o">=/</span><span class="nt">tmp</span><span class="o">/</span><span class="nt">supervisor</span><span class="p">.</span><span class="nc">sock</span>   <span class="o">;</span> <span class="nt">socket文件的路径</span><span class="err">，</span><span class="nt">supervisorctl用XML_RPC和supervisord通信就是通过它进行</span>
                              <span class="nt">的</span><span class="err">。</span><span class="nt">如果不设置的话</span><span class="err">，</span><span class="nt">supervisorctl也就不能用了</span>  
                              <span class="nt">不设置的话</span><span class="err">，</span><span class="nt">默认为none</span><span class="err">。</span> <span class="nt">非必须设置</span>        
<span class="o">;</span><span class="nt">chmod</span><span class="o">=</span><span class="nt">0700</span>                 <span class="o">;</span> <span class="nt">这个简单</span><span class="err">，</span><span class="nt">就是修改上面的那个socket文件的权限为0700</span>
                              <span class="nt">不设置的话</span><span class="err">，</span><span class="nt">默认为0700</span><span class="err">。</span> <span class="nt">非必须设置</span>
<span class="o">;</span><span class="nt">chown</span><span class="o">=</span><span class="nt">nobody</span><span class="p">:</span><span class="nd">nogroup</span>       <span class="o">;</span> <span class="nt">这个一样</span><span class="err">，</span><span class="nt">修改上面的那个socket文件的属组为user</span><span class="p">.</span><span class="nc">group</span>
                              <span class="nt">不设置的话</span><span class="err">，</span><span class="nt">默认为启动supervisord进程的用户及属组</span><span class="err">。</span><span class="nt">非必须设置</span>
<span class="o">;</span><span class="nt">username</span><span class="o">=</span><span class="nt">user</span>              <span class="o">;</span> <span class="nt">使用supervisorctl连接的时候</span><span class="err">，</span><span class="nt">认证的用户</span>
                               <span class="nt">不设置的话</span><span class="err">，</span><span class="nt">默认为不需要用户</span><span class="err">。</span> <span class="nt">非必须设置</span>
<span class="o">;</span><span class="nt">password</span><span class="o">=</span><span class="nt">123</span>               <span class="o">;</span> <span class="nt">和上面的用户名对应的密码</span><span class="err">，</span><span class="nt">可以直接使用明码</span><span class="err">，</span><span class="nt">也可以使用SHA加密</span>
                              <span class="nt">如</span><span class="err">：</span><span class="p">{</span><span class="err">SHA</span><span class="p">}</span><span class="nt">82ab876d1387bfafe46cc1c8a2ef074eae50cb1d</span>
                              <span class="nt">默认不设置</span><span class="err">。。。</span><span class="nt">非必须设置</span>
</pre></div>


<h3 id="section-inet_http_server">Section: inet_http_server<a class="headerlink" href="#section-inet_http_server" title="Permanent link">&para;</a></h3>
<div class="codehilite"><pre><span></span><span class="o">;</span><span class="cp">[</span><span class="nx">inet_http_server</span><span class="cp">]</span>         <span class="o">;</span> <span class="nt">侦听在TCP上的socket</span><span class="err">，</span><span class="nt">Web</span> <span class="nt">Server和远程的supervisorctl都要用到他</span>
                              <span class="nt">不设置的话</span><span class="err">，</span><span class="nt">默认为不开启</span><span class="err">。</span><span class="nt">非必须设置</span>
<span class="o">;</span><span class="nt">port</span><span class="o">=</span><span class="nt">127</span><span class="p">.</span><span class="nc">0</span><span class="p">.</span><span class="nc">0</span><span class="p">.</span><span class="nc">1</span><span class="p">:</span><span class="nd">9001</span>        <span class="o">;</span> <span class="nt">这个是侦听的IP和端口</span><span class="err">，</span><span class="nt">侦听所有IP用</span> <span class="p">:</span><span class="nd">9001或</span><span class="o">*</span><span class="p">:</span><span class="nd">9001</span><span class="err">。</span>
                              <span class="nt">这个必须设置</span><span class="err">，</span><span class="nt">只要上面的</span><span class="cp">[</span><span class="nx">inet_http_server</span><span class="cp">]</span><span class="nt">开启了</span><span class="err">，</span><span class="nt">就必须设置它</span>
<span class="o">;</span><span class="nt">username</span><span class="o">=</span><span class="nt">user</span>              <span class="o">;</span> <span class="nt">这个和上面的uinx_http_server一个样</span><span class="err">。</span><span class="nt">非必须设置</span>
<span class="o">;</span><span class="nt">password</span><span class="o">=</span><span class="nt">123</span>               <span class="o">;</span> <span class="nt">这个也一个样</span><span class="err">。</span><span class="nt">非必须设置</span>
</pre></div>


<h3 id="section-supervisord">Section: supervisord<a class="headerlink" href="#section-supervisord" title="Permanent link">&para;</a></h3>
<div class="codehilite"><pre><span></span>[supervisord]                ;这个主要是定义supervisord这个服务端进程的一些参数的
                              这个必须设置，不设置，supervisor就不用干活了
logfile=/tmp/supervisord.log ; 这个是supervisord这个主进程的日志路径，注意和子进程的日志不搭嘎。
                               默认路径$CWD/supervisord.log，$CWD是当前目录。。非必须设置
logfile_maxbytes=50MB        ; 这个是上面那个日志文件的最大的大小，当超过50M的时候，会生成一个新的日 
                               志文件。当设置为0时，表示不限制文件大小
                               默认值是50M，非必须设置。              
logfile_backups=10           ; 日志文件保持的数量，supervisor在启动程序时，会自动创建10个buckup文件，用于log rotate
                               当设置为0时，表示不限制文件的数量。
                               默认情况下为10。。。非必须设置
loglevel=info                ; 日志级别，有critical, error, warn, info, debug, trace, or blather等
                               默认为info。。。非必须设置项
pidfile=/tmp/supervisord.pid ; supervisord的pid文件路径。
                               默认为$CWD/supervisord.pid。。。非必须设置
nodaemon=false               ; 如果是true，supervisord进程将在前台运行
                               默认为false，也就是后台以守护进程运行。。。非必须设置
minfds=1024                  ; 这个是最少系统空闲的文件描述符，低于这个值supervisor将不会启动。
                               系统的文件描述符在这里设置cat /proc/sys/fs/file-max
                               默认情况下为1024。。。非必须设置
minprocs=200                 ; 最小可用的进程描述符，低于这个值supervisor也将不会正常启动。
                              ulimit  -u这个命令，可以查看linux下面用户的最大进程数
                              默认为200。。。非必须设置
;umask=022                   ; 进程创建文件的掩码
                               默认为022。。非必须设置项
;user=chrism                 ; 这个参数可以设置一个非root用户，当我们以root用户启动supervisord之后。
                               我这里面设置的这个用户，也可以对supervisord进行管理
                               默认情况是不设置。。。非必须设置项
;identifier=supervisor       ; 这个参数是supervisord的标识符，主要是给XML_RPC用的。当你有多个
                               supervisor的时候，而且想调用XML_RPC统一管理，就需要为每个
                               supervisor设置不同的标识符了
                               默认是supervisord。。。非必需设置
;directory=/tmp              ; 这个参数是当supervisord作为守护进程运行的时候，设置这个参数的话，启动
                               supervisord进程之前，会先切换到这个目录
                               默认不设置。。。非必须设置
;nocleanup=true              ; 这个参数当为false的时候，会在supervisord进程启动的时候，把以前子进程
                               产生的日志文件(路径为AUTO的情况下)清除掉。有时候咱们想要看历史日志，当 
                               然不想日志被清除了。所以可以设置为true
                               默认是false，有调试需求的同学可以设置为true。。。非必须设置
;childlogdir=/tmp            ; 当子进程日志路径为AUTO的时候，子进程日志文件的存放路径。
                               默认路径是这个东西，执行下面的这个命令看看就OK了，处理的东西就默认路径
                               python -c &quot;import tempfile;print tempfile.gettempdir()&quot;
                               非必须设置
;environment=KEY=&quot;value&quot;     ; 这个是用来设置环境变量的，supervisord在linux中启动默认继承了linux的
                               环境变量，在这里可以设置supervisord进程特有的其他环境变量。
                               supervisord启动子进程时，子进程会拷贝父进程的内存空间内容。 所以设置的
                               这些环境变量也会被子进程继承。
                               小例子：environment=name=&quot;haha&quot;,age=&quot;hehe&quot;
                               默认为不设置。。。非必须设置
;strip_ansi=false            ; 这个选项如果设置为true，会清除子进程日志中的所有ANSI 序列。什么是ANSI
                               序列呢？就是我们的\n,\t这些东西。
                               默认为false。。。非必须设置
</pre></div>


<h3 id="section-rpcinterface">Section: rpcinterface<a class="headerlink" href="#section-rpcinterface" title="Permanent link">&para;</a></h3>
<div class="codehilite"><pre><span></span><span class="o">;</span> <span class="nt">the</span> <span class="nt">below</span> <span class="nt">section</span> <span class="nt">must</span> <span class="nt">remain</span> <span class="nt">in</span> <span class="nt">the</span> <span class="nt">config</span> <span class="nt">file</span> <span class="nt">for</span> <span class="nt">RPC</span>
<span class="o">;</span> <span class="o">(</span><span class="nt">supervisorctl</span><span class="o">/</span><span class="nt">web</span> <span class="nt">interface</span><span class="o">)</span> <span class="nt">to</span> <span class="nt">work</span><span class="o">,</span> <span class="nt">additional</span> <span class="nt">interfaces</span> <span class="nt">may</span> <span class="nt">be</span>
<span class="o">;</span> <span class="nt">added</span> <span class="nt">by</span> <span class="nt">defining</span> <span class="nt">them</span> <span class="nt">in</span> <span class="nt">separate</span> <span class="nt">rpcinterface</span><span class="o">:</span> <span class="nt">sections</span>
<span class="cp">[</span><span class="nx">rpcinterface</span><span class="p">:</span><span class="nx">supervisor</span><span class="cp">]</span>    <span class="o">;</span><span class="nt">这个选项是给XML_RPC用的</span><span class="err">，</span><span class="nt">当然你如果想使用supervisord或者web</span> <span class="nt">server</span> <span class="nt">这</span> 
                              <span class="nt">个选项必须要开启的</span>
<span class="nt">supervisor</span><span class="p">.</span><span class="nc">rpcinterface_factory</span> <span class="o">=</span> <span class="nt">supervisor</span><span class="p">.</span><span class="nc">rpcinterface</span><span class="p">:</span><span class="nd">make_main_rpcinterface</span> 
</pre></div>


<h3 id="section-supervisorctl">Section: supervisorctl<a class="headerlink" href="#section-supervisorctl" title="Permanent link">&para;</a></h3>
<div class="codehilite"><pre><span></span><span class="cp">[</span><span class="nx">supervisorctl</span><span class="cp">]</span>              <span class="o">;</span><span class="nt">这个主要是针对supervisorctl的一些配置</span>  
<span class="nt">serverurl</span><span class="o">=</span><span class="nt">unix</span><span class="o">:///</span><span class="nt">tmp</span><span class="o">/</span><span class="nt">supervisor</span><span class="p">.</span><span class="nc">sock</span> <span class="o">;</span> <span class="nt">这个是supervisorctl本地连接supervisord的时候</span><span class="err">，</span><span class="nt">本地UNIX</span> <span class="nt">socket</span>
                                        <span class="nt">路径</span><span class="err">，</span><span class="nt">注意这个是和前面的</span><span class="cp">[</span><span class="nx">unix_http_server</span><span class="cp">]</span><span class="nt">对应的</span>
                                        <span class="nt">默认值就是unix</span><span class="o">:///</span><span class="nt">tmp</span><span class="o">/</span><span class="nt">supervisor</span><span class="p">.</span><span class="nc">sock</span><span class="err">。。</span><span class="nt">非必须设置</span>
<span class="o">;</span><span class="nt">serverurl</span><span class="o">=</span><span class="nt">http</span><span class="o">://</span><span class="nt">127</span><span class="p">.</span><span class="nc">0</span><span class="p">.</span><span class="nc">0</span><span class="p">.</span><span class="nc">1</span><span class="p">:</span><span class="nd">9001</span> <span class="o">;</span> <span class="nt">这个是supervisorctl远程连接supervisord的时候</span><span class="err">，</span><span class="nt">用到的TCP</span> <span class="nt">socket路径</span>
                                   <span class="nt">注意这个和前面的</span><span class="cp">[</span><span class="nx">inet_http_server</span><span class="cp">]</span><span class="nt">对应</span>
                                   <span class="nt">默认就是http</span><span class="o">://</span><span class="nt">127</span><span class="p">.</span><span class="nc">0</span><span class="p">.</span><span class="nc">0</span><span class="p">.</span><span class="nc">1</span><span class="p">:</span><span class="nd">9001</span><span class="err">。。。</span><span class="nt">非必须项</span>

<span class="o">;</span><span class="nt">username</span><span class="o">=</span><span class="nt">chris</span>              <span class="o">;</span> <span class="nt">用户名</span>
                               <span class="nt">默认空</span><span class="err">。。</span><span class="nt">非必须设置</span>
<span class="o">;</span><span class="nt">password</span><span class="o">=</span><span class="nt">123</span>                <span class="o">;</span> <span class="nt">密码</span>
                              <span class="nt">默认空</span><span class="err">。。</span><span class="nt">非必须设置</span>
<span class="o">;</span><span class="nt">prompt</span><span class="o">=</span><span class="nt">mysupervisor</span>         <span class="o">;</span> <span class="nt">输入用户名密码时候的提示符</span>
                               <span class="nt">默认supervisor</span><span class="err">。。</span><span class="nt">非必须设置</span>
<span class="o">;</span><span class="nt">history_file</span><span class="o">=~/</span><span class="p">.</span><span class="nc">sc_history</span>  <span class="o">;</span> <span class="nt">这个参数和shell中的history类似</span><span class="err">，</span><span class="nt">我们可以用上下键来查找前面执行过的命令</span>
                               <span class="nt">默认是no</span> <span class="nt">file的</span><span class="err">。。</span><span class="nt">所以我们想要有这种功能</span><span class="err">，</span><span class="nt">必须指定一个文件</span><span class="err">。。。</span><span class="nt">非</span>
                               <span class="nt">必须设置</span>
</pre></div>


<h3 id="section-program">Section: program<a class="headerlink" href="#section-program" title="Permanent link">&para;</a></h3>
<div class="codehilite"><pre><span></span><span class="o">;</span> <span class="nt">The</span> <span class="nt">below</span> <span class="nt">sample</span> <span class="nt">program</span> <span class="nt">section</span> <span class="nt">shows</span> <span class="nt">all</span> <span class="nt">possible</span> <span class="nt">program</span> <span class="nt">subsection</span> <span class="nt">values</span><span class="o">,</span>
<span class="o">;</span> <span class="nt">create</span> <span class="nt">one</span> <span class="nt">or</span> <span class="nt">more</span> <span class="s1">&#39;real&#39;</span> <span class="nt">program</span><span class="o">:</span> <span class="nt">sections</span> <span class="nt">to</span> <span class="nt">be</span> <span class="nt">able</span> <span class="nt">to</span> <span class="nt">control</span> <span class="nt">them</span> <span class="nt">under</span>
<span class="o">;</span> <span class="nt">supervisor</span><span class="o">.</span>

<span class="o">;</span><span class="cp">[</span><span class="nx">program</span><span class="p">:</span><span class="nx">theprogramname</span><span class="cp">]</span>      <span class="o">;</span><span class="nt">这个就是咱们要管理的子进程了</span><span class="err">，</span><span class="s2">&quot;:&quot;</span><span class="nt">后面的是名字</span><span class="err">，</span><span class="nt">最好别乱写和实际进程</span>
                                <span class="nt">有点关联最好</span><span class="err">。</span><span class="nt">这样的program我们可以设置一个或多个</span><span class="err">，</span><span class="nt">一个program就是</span>
                                <span class="nt">要被管理的一个进程</span>
<span class="o">;</span><span class="nt">command</span><span class="o">=/</span><span class="nt">bin</span><span class="o">/</span><span class="nt">cat</span>              <span class="o">;</span> <span class="nt">这个就是我们的要启动进程的命令路径了</span><span class="err">，</span><span class="nt">可以带参数</span>
                                <span class="nt">例子</span><span class="err">：</span><span class="o">/</span><span class="nt">home</span><span class="o">/</span><span class="nt">test</span><span class="p">.</span><span class="nc">py</span> <span class="nt">-a</span> <span class="s1">&#39;hehe&#39;</span>
                                <span class="nt">有一点需要注意的是</span><span class="err">，</span><span class="nt">我们的command只能是那种在终端运行的进程</span><span class="err">，</span><span class="nt">不能是</span>
                                <span class="nt">守护进程</span><span class="err">。</span><span class="nt">这个想想也知道了</span><span class="err">，</span><span class="nt">比如说command</span><span class="o">=</span><span class="nt">service</span> <span class="nt">httpd</span> <span class="nt">start</span><span class="err">。</span>
                                <span class="nt">httpd这个进程被linux的service管理了</span><span class="err">，</span><span class="nt">我们的supervisor再去启动这个命令</span>
                                <span class="nt">这已经不是严格意义的子进程了</span><span class="err">。</span>
                                <span class="nt">这个是个必须设置的项</span>
<span class="o">;</span><span class="nt">process_name</span><span class="o">=%(</span><span class="nt">program_name</span><span class="o">)</span><span class="nt">s</span> <span class="o">;</span> <span class="nt">这个是进程名</span><span class="err">，</span><span class="nt">如果我们下面的numprocs参数为1的话</span><span class="err">，</span><span class="nt">就不用管这个参数</span>
                                 <span class="nt">了</span><span class="err">，</span><span class="nt">它默认值</span><span class="o">%(</span><span class="nt">program_name</span><span class="o">)</span><span class="nt">s也就是上面的那个program冒号后面的名字</span><span class="err">，</span>
                                 <span class="nt">但是如果numprocs为多个的话</span><span class="err">，</span><span class="nt">那就不能这么干了</span><span class="err">。</span><span class="nt">想想也知道</span><span class="err">，</span><span class="nt">不可能每个</span>
                                 <span class="nt">进程都用同一个进程名吧</span><span class="err">。</span>


<span class="o">;</span><span class="nt">numprocs</span><span class="o">=</span><span class="nt">1</span>                    <span class="o">;</span> <span class="nt">启动进程的数目</span><span class="err">。</span><span class="nt">当不为1时</span><span class="err">，</span><span class="nt">就是进程池的概念</span><span class="err">，</span><span class="nt">注意process_name的设置</span>
                                 <span class="nt">默认为1</span>    <span class="err">。。</span><span class="nt">非必须设置</span>
<span class="o">;</span><span class="nt">directory</span><span class="o">=/</span><span class="nt">tmp</span>                <span class="o">;</span> <span class="nt">进程运行前</span><span class="err">，</span><span class="nt">会前切换到这个目录</span>
                                 <span class="nt">默认不设置</span><span class="err">。。。</span><span class="nt">非必须设置</span>
<span class="o">;</span><span class="nt">umask</span><span class="o">=</span><span class="nt">022</span>                     <span class="o">;</span> <span class="nt">进程掩码</span><span class="err">，</span><span class="nt">默认none</span><span class="err">，</span><span class="nt">非必须</span>
<span class="o">;</span><span class="nt">priority</span><span class="o">=</span><span class="nt">999</span>                  <span class="o">;</span> <span class="nt">子进程启动关闭优先级</span><span class="err">，</span><span class="nt">优先级低的</span><span class="err">，</span><span class="nt">最先启动</span><span class="err">，</span><span class="nt">关闭的时候最后关闭</span>
                                 <span class="nt">默认值为999</span> <span class="err">。。</span><span class="nt">非必须设置</span>
<span class="o">;</span><span class="nt">autostart</span><span class="o">=</span><span class="nt">true</span>                <span class="o">;</span> <span class="nt">如果是true的话</span><span class="err">，</span><span class="nt">子进程将在supervisord启动后被自动启动</span>
                                 <span class="nt">默认就是true</span>   <span class="err">。。</span><span class="nt">非必须设置</span>
<span class="o">;</span><span class="nt">autorestart</span><span class="o">=</span><span class="nt">unexpected</span>        <span class="o">;</span> <span class="nt">这个是设置子进程挂掉后自动重启的情况</span><span class="err">，</span><span class="nt">有三个选项</span><span class="err">，</span><span class="nt">false</span><span class="o">,</span><span class="nt">unexpected</span>
                                 <span class="nt">和true</span><span class="err">。</span><span class="nt">如果为false的时候</span><span class="err">，</span><span class="nt">无论什么情况下</span><span class="err">，</span><span class="nt">都不会被重新启动</span><span class="err">，</span>
                                 <span class="nt">如果为unexpected</span><span class="err">，</span><span class="nt">只有当进程的退出码不在下面的exitcodes里面定义的退</span> 
                                 <span class="nt">出码的时候</span><span class="err">，</span><span class="nt">才会被自动重启</span><span class="err">。</span><span class="nt">当为true的时候</span><span class="err">，</span><span class="nt">只要子进程挂掉</span><span class="err">，</span><span class="nt">将会被无</span>
                                 <span class="nt">条件的重启</span>
<span class="o">;</span><span class="nt">startsecs</span><span class="o">=</span><span class="nt">1</span>                   <span class="o">;</span> <span class="nt">这个选项是子进程启动多少秒之后</span><span class="err">，</span><span class="nt">此时状态如果是running</span><span class="err">，</span><span class="nt">则我们认为启</span>
                                 <span class="nt">动成功了</span>
                                 <span class="nt">默认值为1</span> <span class="err">。。</span><span class="nt">非必须设置</span>
<span class="o">;</span><span class="nt">startretries</span><span class="o">=</span><span class="nt">3</span>                <span class="o">;</span> <span class="nt">当进程启动失败后</span><span class="err">，</span><span class="nt">最大尝试启动的次数</span><span class="err">。。</span><span class="nt">当超过3次后</span><span class="err">，</span><span class="nt">supervisor将把</span>
                                 <span class="nt">此进程的状态置为FAIL</span>
                                 <span class="nt">默认值为3</span> <span class="err">。。</span><span class="nt">非必须设置</span>
<span class="o">;</span><span class="nt">exitcodes</span><span class="o">=</span><span class="nt">0</span><span class="o">,</span><span class="nt">2</span>                 <span class="o">;</span> <span class="nt">注意和上面的的autorestart</span><span class="o">=</span><span class="nt">unexpected对应</span><span class="err">。。</span><span class="nt">exitcodes里面的定义的</span>
                                 <span class="nt">退出码是expected的</span><span class="err">。</span>
<span class="o">;</span><span class="nt">stopsignal</span><span class="o">=</span><span class="nt">QUIT</span>               <span class="o">;</span> <span class="nt">进程停止信号</span><span class="err">，</span><span class="nt">可以为TERM</span><span class="o">,</span> <span class="nt">HUP</span><span class="o">,</span> <span class="nt">INT</span><span class="o">,</span> <span class="nt">QUIT</span><span class="o">,</span> <span class="nt">KILL</span><span class="o">,</span> <span class="nt">USR1</span><span class="o">,</span> <span class="nt">or</span> <span class="nt">USR2等信号</span>
                                  <span class="nt">默认为TERM</span> <span class="err">。。</span><span class="nt">当用设定的信号去干掉进程</span><span class="err">，</span><span class="nt">退出码会被认为是expected</span>
                                  <span class="nt">非必须设置</span>
<span class="o">;</span><span class="nt">stopwaitsecs</span><span class="o">=</span><span class="nt">10</span>               <span class="o">;</span> <span class="nt">这个是当我们向子进程发送stopsignal信号后</span><span class="err">，</span><span class="nt">到系统返回信息</span>
                                 <span class="nt">给supervisord</span><span class="err">，</span><span class="nt">所等待的最大时间</span><span class="err">。</span> <span class="nt">超过这个时间</span><span class="err">，</span><span class="nt">supervisord会向该</span>
                                 <span class="nt">子进程发送一个强制kill的信号</span><span class="err">。</span>
                                 <span class="nt">默认为10秒</span><span class="err">。。</span><span class="nt">非必须设置</span>
<span class="o">;</span><span class="nt">stopasgroup</span><span class="o">=</span><span class="nt">false</span>             <span class="o">;</span> <span class="nt">这个东西主要用于</span><span class="err">，</span><span class="nt">supervisord管理的子进程</span><span class="err">，</span><span class="nt">这个子进程本身还有</span>
                                 <span class="nt">子进程</span><span class="err">。</span><span class="nt">那么我们如果仅仅干掉supervisord的子进程的话</span><span class="err">，</span><span class="nt">子进程的子进程</span>
                                 <span class="nt">有可能会变成孤儿进程</span><span class="err">。</span><span class="nt">所以咱们可以设置可个选项</span><span class="err">，</span><span class="nt">把整个该子进程的</span>
                                 <span class="nt">整个进程组都干掉</span><span class="err">。</span> <span class="nt">设置为true的话</span><span class="err">，</span><span class="nt">一般killasgroup也会被设置为true</span><span class="err">。</span>
                                 <span class="nt">需要注意的是</span><span class="err">，</span><span class="nt">该选项发送的是stop信号</span>
                                 <span class="nt">默认为false</span><span class="err">。。</span><span class="nt">非必须设置</span><span class="err">。。</span>
<span class="o">;</span><span class="nt">killasgroup</span><span class="o">=</span><span class="nt">false</span>             <span class="o">;</span> <span class="nt">这个和上面的stopasgroup类似</span><span class="err">，</span><span class="nt">不过发送的是kill信号</span>
<span class="o">;</span><span class="nt">user</span><span class="o">=</span><span class="nt">chrism</span>                   <span class="o">;</span> <span class="nt">如果supervisord是root启动</span><span class="err">，</span><span class="nt">我们在这里设置这个非root用户</span><span class="err">，</span><span class="nt">可以用来</span>
                                 <span class="nt">管理该program</span>
                                 <span class="nt">默认不设置</span><span class="err">。。。</span><span class="nt">非必须设置项</span>
<span class="o">;</span><span class="nt">redirect_stderr</span><span class="o">=</span><span class="nt">true</span>          <span class="o">;</span> <span class="nt">如果为true</span><span class="err">，</span><span class="nt">则stderr的日志会被写入stdout日志文件中</span>
                                 <span class="nt">默认为false</span><span class="err">，</span><span class="nt">非必须设置</span>
<span class="o">;</span><span class="nt">stdout_logfile</span><span class="o">=/</span><span class="nt">a</span><span class="o">/</span><span class="nt">path</span>        <span class="o">;</span> <span class="nt">子进程的stdout的日志路径</span><span class="err">，</span><span class="nt">可以指定路径</span><span class="err">，</span><span class="nt">AUTO</span><span class="err">，</span><span class="nt">none等三个选项</span><span class="err">。</span>
                                 <span class="nt">设置为none的话</span><span class="err">，</span><span class="nt">将没有日志产生</span><span class="err">。</span><span class="nt">设置为AUTO的话</span><span class="err">，</span><span class="nt">将随机找一个地方</span>
                                 <span class="nt">生成日志文件</span><span class="err">，</span><span class="nt">而且当supervisord重新启动的时候</span><span class="err">，</span><span class="nt">以前的日志文件会被</span>
                                 <span class="nt">清空</span><span class="err">。</span><span class="nt">当</span> <span class="nt">redirect_stderr</span><span class="o">=</span><span class="nt">true的时候</span><span class="err">，</span><span class="nt">sterr也会写进这个日志文件</span>
<span class="o">;</span><span class="nt">stdout_logfile_maxbytes</span><span class="o">=</span><span class="nt">1MB</span>   <span class="o">;</span> <span class="nt">日志文件最大大小</span><span class="err">，</span><span class="nt">和</span><span class="cp">[</span><span class="nx">supervisord</span><span class="cp">]</span><span class="nt">中定义的一样</span><span class="err">。</span><span class="nt">默认为50</span>
<span class="o">;</span><span class="nt">stdout_logfile_backups</span><span class="o">=</span><span class="nt">10</span>     <span class="o">;</span> <span class="nt">和</span><span class="cp">[</span><span class="nx">supervisord</span><span class="cp">]</span><span class="nt">定义的一样</span><span class="err">。</span><span class="nt">默认10</span>
<span class="o">;</span><span class="nt">stdout_capture_maxbytes</span><span class="o">=</span><span class="nt">1MB</span>   <span class="o">;</span> <span class="nt">这个东西是设定capture管道的大小</span><span class="err">，</span><span class="nt">当值不为0的时候</span><span class="err">，</span><span class="nt">子进程可以从stdout</span>
                                 <span class="nt">发送信息</span><span class="err">，</span><span class="nt">而supervisor可以根据信息</span><span class="err">，</span><span class="nt">发送相应的event</span><span class="err">。</span>
                                 <span class="nt">默认为0</span><span class="err">，</span><span class="nt">为0的时候表达关闭管道</span><span class="err">。。。</span><span class="nt">非必须项</span>
<span class="o">;</span><span class="nt">stdout_events_enabled</span><span class="o">=</span><span class="nt">false</span>   <span class="o">;</span> <span class="nt">当设置为ture的时候</span><span class="err">，</span><span class="nt">当子进程由stdout向文件描述符中写日志的时候</span><span class="err">，</span><span class="nt">将</span>
                                 <span class="nt">触发supervisord发送PROCESS_LOG_STDOUT类型的event</span>
                                 <span class="nt">默认为false</span><span class="err">。。。</span><span class="nt">非必须设置</span>
<span class="o">;</span><span class="nt">stderr_logfile</span><span class="o">=/</span><span class="nt">a</span><span class="o">/</span><span class="nt">path</span>        <span class="o">;</span> <span class="nt">这个东西是设置stderr写的日志路径</span><span class="err">，</span><span class="nt">当redirect_stderr</span><span class="o">=</span><span class="nt">true</span><span class="err">。</span><span class="nt">这个就不用</span>
                                 <span class="nt">设置了</span><span class="err">，</span><span class="nt">设置了也是白搭</span><span class="err">。</span><span class="nt">因为它会被写入stdout_logfile的同一个文件中</span>
                                 <span class="nt">默认为AUTO</span><span class="err">，</span><span class="nt">也就是随便找个地存</span><span class="err">，</span><span class="nt">supervisord重启被清空</span><span class="err">。。</span><span class="nt">非必须设置</span>
<span class="o">;</span><span class="nt">stderr_logfile_maxbytes</span><span class="o">=</span><span class="nt">1MB</span>   <span class="o">;</span> <span class="nt">这个出现好几次了</span><span class="err">，</span><span class="nt">就不重复了</span>
<span class="o">;</span><span class="nt">stderr_logfile_backups</span><span class="o">=</span><span class="nt">10</span>     <span class="o">;</span> <span class="nt">这个也是</span>
<span class="o">;</span><span class="nt">stderr_capture_maxbytes</span><span class="o">=</span><span class="nt">1MB</span>   <span class="o">;</span> <span class="nt">这个一样</span><span class="err">，</span><span class="nt">和stdout_capture一样</span><span class="err">。</span> <span class="nt">默认为0</span><span class="err">，</span><span class="nt">关闭状态</span>
<span class="o">;</span><span class="nt">stderr_events_enabled</span><span class="o">=</span><span class="nt">false</span>   <span class="o">;</span> <span class="nt">这个也是一样</span><span class="err">，</span><span class="nt">默认为false</span>
<span class="o">;</span><span class="nt">environment</span><span class="o">=</span><span class="nt">A</span><span class="o">=</span><span class="s2">&quot;1&quot;</span><span class="o">,</span><span class="nt">B</span><span class="o">=</span><span class="s2">&quot;2&quot;</span>       <span class="o">;</span> <span class="nt">这个是该子进程的环境变量</span><span class="err">，</span><span class="nt">和别的子进程是不共享的</span>
<span class="o">;</span><span class="nt">serverurl</span><span class="o">=</span><span class="nt">AUTO</span>                <span class="o">;</span> 
</pre></div>


<h3 id="section-eventlistener">Section: eventlistener<a class="headerlink" href="#section-eventlistener" title="Permanent link">&para;</a></h3>
<div class="codehilite"><pre><span></span><span class="c1">; The below sample eventlistener section shows all possible</span>
<span class="c1">; eventlistener subsection values, create one or more &#39;real&#39;</span>
<span class="c1">; eventlistener: sections to be able to handle event notifications</span>
<span class="c1">; sent by supervisor.</span>

<span class="c1">;[eventlistener:theeventlistenername] ;这个东西其实和program的地位是一样的，也是suopervisor启动的子进</span>
                                       <span class="na">程，不过它干的活是订阅supervisord发送的event。他的名字就叫</span>
                                       <span class="na">listener了。我们可以在listener里面做一系列处理，比如报警等等</span>
                                       <span class="na">楼主这两天干的活，就是弄的这玩意</span>
<span class="c1">;command=/bin/eventlistener    ; 这个和上面的program一样，表示listener的可执行文件的路径</span>
<span class="c1">;process_name=%(program_name)s ; 这个也一样，进程名，当下面的numprocs为多个的时候，才需要。否则默认就</span>
                                 <span class="na">OK了</span>
<span class="c1">;numprocs=1                    ; 相同的listener启动的个数</span>
<span class="c1">;events=EVENT                  ; event事件的类型，也就是说，只有写在这个地方的事件类型。才会被发送</span>


<span class="c1">;buffer_size=10                ; 这个是event队列缓存大小，单位不太清楚，楼主猜测应该是个吧。当buffer</span>
                                 <span class="na">超过10的时候，最旧的event将会被清除，并把新的event放进去。</span>
                                 <span class="na">默认值为10。。非必须选项</span>
<span class="c1">;directory=/tmp                ; 进程执行前，会切换到这个目录下执行</span>
                                 <span class="na">默认为不切换。。。非必须</span>
<span class="c1">;umask=022                     ; 淹没，默认为none，不说了</span>
<span class="c1">;priority=-1                   ; 启动优先级，默认-1，也不扯了</span>
<span class="c1">;autostart=true                ; 是否随supervisord启动一起启动，默认true</span>
<span class="c1">;autorestart=unexpected        ; 是否自动重启，和program一个样，分true,false,unexpected等，注意</span>
                                  <span class="na">unexpected和exitcodes的关系</span>
<span class="c1">;startsecs=1                   ; 也是一样，进程启动后跑了几秒钟，才被认定为成功启动，默认1</span>
<span class="c1">;startretries=3                ; 失败最大尝试次数，默认3</span>
<span class="c1">;exitcodes=0,2                 ; 期望或者说预料中的进程退出码，</span>
<span class="c1">;stopsignal=QUIT               ; 干掉进程的信号，默认为TERM，比如设置为QUIT，那么如果QUIT来干这个进程</span>
                                 <span class="na">那么会被认为是正常维护，退出码也被认为是expected中的</span>
<span class="c1">;stopwaitsecs=10               ; max num secs to wait b4 SIGKILL (default 10)</span>
<span class="c1">;stopasgroup=false             ; send stop signal to the UNIX process group (default false)</span>
<span class="c1">;killasgroup=false             ; SIGKILL the UNIX process group (def false)</span>
<span class="c1">;user=chrism                   ;设置普通用户，可以用来管理该listener进程。</span>
                                <span class="na">默认为空。。非必须设置</span>
<span class="c1">;redirect_stderr=true          ; 为true的话，stderr的log会并入stdout的log里面</span>
                                <span class="na">默认为false。。。非必须设置</span>
<span class="c1">;stdout_logfile=/a/path        ; 这个不说了，好几遍了</span>
<span class="c1">;stdout_logfile_maxbytes=1MB   ; 这个也是</span>
<span class="c1">;stdout_logfile_backups=10     ; 这个也是</span>
<span class="c1">;stdout_events_enabled=false   ; 这个其实是错的，listener是不能发送event</span>
<span class="c1">;stderr_logfile=/a/path        ; 这个也是</span>
<span class="c1">;stderr_logfile_maxbytes=1MB   ; 这个也是</span>
<span class="c1">;stderr_logfile_backups        ; 这个不说了</span>
<span class="c1">;stderr_events_enabled=false   ; 这个也是错的，listener不能发送event</span>
<span class="c1">;environment=A=&quot;1&quot;,B=&quot;2&quot;       ; 这个是该子进程的环境变量</span>
                                 <span class="na">默认为空。。。非必须设置</span>
<span class="c1">;serverurl=AUTO                ; override serverurl computation (childutils)</span>
</pre></div>


<h3 id="section-group">Section: group<a class="headerlink" href="#section-group" title="Permanent link">&para;</a></h3>
<div class="codehilite"><pre><span></span><span class="o">;</span> <span class="nt">The</span> <span class="nt">below</span> <span class="nt">sample</span> <span class="nt">group</span> <span class="nt">section</span> <span class="nt">shows</span> <span class="nt">all</span> <span class="nt">possible</span> <span class="nt">group</span> <span class="nt">values</span><span class="o">,</span>
<span class="o">;</span> <span class="nt">create</span> <span class="nt">one</span> <span class="nt">or</span> <span class="nt">more</span> <span class="s1">&#39;real&#39;</span> <span class="nt">group</span><span class="o">:</span> <span class="nt">sections</span> <span class="nt">to</span> <span class="nt">create</span> <span class="s2">&quot;heterogeneous&quot;</span>
<span class="o">;</span> <span class="nt">process</span> <span class="nt">groups</span><span class="o">.</span>

<span class="o">;</span><span class="cp">[</span><span class="k">group</span><span class="p">:</span><span class="nx">thegroupname</span><span class="cp">]</span>  <span class="o">;</span><span class="nt">这个东西就是给programs分组</span><span class="err">，</span><span class="nt">划分到组里面的program</span><span class="err">。</span><span class="nt">我们就不用一个一个去操作了</span>
                         <span class="nt">我们可以对组名进行统一的操作</span><span class="err">。</span> <span class="nt">注意</span><span class="err">：</span><span class="nt">program被划分到组里面之后</span><span class="err">，</span><span class="nt">就相当于原来</span>
                         <span class="nt">的配置从supervisor的配置文件里消失了</span><span class="err">。。。</span><span class="nt">supervisor只会对组进行管理</span><span class="err">，</span><span class="nt">而不再</span>
                         <span class="nt">会对组里面的单个program进行管理了</span>
<span class="o">;</span><span class="nt">programs</span><span class="o">=</span><span class="nt">progname1</span><span class="o">,</span><span class="nt">progname2</span>  <span class="o">;</span> <span class="nt">组成员</span><span class="err">，</span><span class="nt">用逗号分开</span>
                                 <span class="nt">这个是个必须的设置项</span>
<span class="o">;</span><span class="nt">priority</span><span class="o">=</span><span class="nt">999</span>                  <span class="o">;</span> <span class="nt">优先级</span><span class="err">，</span><span class="nt">相对于组和组之间说的</span>
                                 <span class="nt">默认999</span><span class="err">。。</span><span class="nt">非必须选项</span>
</pre></div>


<h3 id="section-include">Section: include<a class="headerlink" href="#section-include" title="Permanent link">&para;</a></h3>
<div class="codehilite"><pre><span></span>; The [include] section can just contain the &quot;files&quot; setting.  This
; setting can list multiple files (separated by whitespace or
; newlines).  It can also contain wildcards.  The filenames are
; interpreted as relative to this file.  Included files *cannot*
; include files themselves.

;[include]                         ;这个东西挺有用的，当我们要管理的进程很多的时候，写在一个文件里面
                                    就有点大了。我们可以把配置信息写到多个文件中，然后include过来
;files = relative/directory/*.ini
</pre></div>


<h2 id="supervisord">supervisord<a class="headerlink" href="#supervisord" title="Permanent link">&para;</a></h2>
<div class="codehilite"><pre><span></span>$ supervisord --h
supervisord -- run a <span class="nb">set</span> of applications as daemons.

Usage: /usr/local/bin/supervisord <span class="o">[</span>options<span class="o">]</span>

Options:
-c/--configuration FILENAME -- configuration file path <span class="o">(</span>searches <span class="k">if</span> not given<span class="o">)</span>
-n/--nodaemon -- run in the foreground <span class="o">(</span>same as <span class="s1">&#39;nodaemon=true&#39;</span> in config file<span class="o">)</span>
-h/--help -- print this usage message and <span class="nb">exit</span>
-v/--version -- print supervisord version number and <span class="nb">exit</span>
-u/--user USER -- run supervisord as this user <span class="o">(</span>or numeric uid<span class="o">)</span>
-m/--umask UMASK -- use this <span class="nb">umask</span> <span class="k">for</span> daemon subprocess <span class="o">(</span>default is <span class="m">022</span><span class="o">)</span>
-d/--directory DIRECTORY -- directory to chdir to when daemonized
-l/--logfile FILENAME -- use FILENAME as logfile path
-y/--logfile_maxbytes BYTES -- use BYTES to limit the max size of logfile
-z/--logfile_backups NUM -- number of backups to keep when max bytes reached
-e/--loglevel LEVEL -- use LEVEL as log level <span class="o">(</span>debug,info,warn,error,critical<span class="o">)</span>
-j/--pidfile FILENAME -- write a pid file <span class="k">for</span> the daemon process to FILENAME
-i/--identifier STR -- identifier used <span class="k">for</span> this instance of supervisord
-q/--childlogdir DIRECTORY -- the log directory <span class="k">for</span> child process logs
-k/--nocleanup --  prevent the process from performing cleanup <span class="o">(</span>removal of
                   old automatic child log files<span class="o">)</span> at startup.
-a/--minfds NUM -- the minimum number of file descriptors <span class="k">for</span> start success
-t/--strip_ansi -- strip ansi escape codes from process output
--minprocs NUM  -- the minimum number of processes available <span class="k">for</span> start success
--profile_options OPTIONS -- run supervisord under profiler and output
                             results based on OPTIONS, which  is a comma-sep<span class="s1">&#39;d</span>
<span class="s1">                             list of &#39;</span>cumulative<span class="s1">&#39;, &#39;</span>calls<span class="s1">&#39;, and/or &#39;</span>callers<span class="s1">&#39;,</span>
<span class="s1">                             e.g. &#39;</span>cumulative,callers<span class="err">&#39;</span><span class="o">)</span>
</pre></div>


<h2 id="supervisorctl">supervisorctl<a class="headerlink" href="#supervisorctl" title="Permanent link">&para;</a></h2>
<div class="codehilite"><pre><span></span>$ supervisorctl --help
supervisorctl -- control applications run by supervisord from the cmd line.

Usage: /usr/local/bin/supervisorctl <span class="o">[</span>options<span class="o">]</span> <span class="o">[</span>action <span class="o">[</span>arguments<span class="o">]]</span>

Options:
-c/--configuration FILENAME -- configuration file path <span class="o">(</span>searches <span class="k">if</span> not given<span class="o">)</span>
-h/--help -- print usage message and <span class="nb">exit</span>
-i/--interactive -- start an interactive shell after executing commands
-s/--serverurl URL -- URL on which supervisord server is listening
     <span class="o">(</span>default <span class="s2">&quot;http://localhost:9001&quot;</span><span class="o">)</span>.
-u/--username USERNAME -- username to use <span class="k">for</span> authentication with server
-p/--password PASSWORD -- password to use <span class="k">for</span> authentication with server
-r/--history-file -- keep a readline <span class="nb">history</span> <span class="o">(</span><span class="k">if</span> readline is available<span class="o">)</span>

action <span class="o">[</span>arguments<span class="o">]</span> -- see below

Actions are commands like <span class="s2">&quot;tail&quot;</span> or <span class="s2">&quot;stop&quot;</span>.  If -i is specified or no action is
specified on the <span class="nb">command</span> line, a <span class="s2">&quot;shell&quot;</span> interpreting actions typed
interactively is started.  Use the action <span class="s2">&quot;help&quot;</span> to find out about available
actions.
</pre></div>


<table>
<thead>
<tr>
<th>选项</th>
<th>解释</th>
</tr>
</thead>
<tbody>
<tr>
<td>-c/--configuration FILENAME</td>
<td>configuration file path (searches if not given)</td>
</tr>
<tr>
<td>-h/--help</td>
<td>print usage message and exit</td>
</tr>
<tr>
<td>-i/--interactive</td>
<td>start an interactive shell after executing commands</td>
</tr>
<tr>
<td>-s/--serverurl URL</td>
<td>URL on which supervisord server is listening<br/>(default "<a href="http://localhost:9001">http://localhost:9001</a>").</td>
</tr>
<tr>
<td>-u/--username USERNAME</td>
<td>username to use for authentication with server</td>
</tr>
<tr>
<td>-p/--password PASSWORD</td>
<td>password to use for authentication with server</td>
</tr>
<tr>
<td>-r/--history-file</td>
<td>keep a readline history (if readline is available)</td>
</tr>
</tbody>
</table>
                
                  
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        powered by
        <a href="https://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../assets/javascripts/application.b806dc00.js"></script>
      
        
        
          
          <script src="../../assets/javascripts/lunr/lunr.stemmer.support.js"></script>
          
            
              
                <script src="../../assets/javascripts/lunr/tinyseg.js"></script>
              
              
                <script src="../../assets/javascripts/lunr/lunr.jp.js"></script>
              
            
          
          
        
      
      <script>app.initialize({version:"1.0.4",url:{base:"../.."}})</script>
      
        <script src="../../js/extra.js"></script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML"></script>
      
    
  </body>
</html>