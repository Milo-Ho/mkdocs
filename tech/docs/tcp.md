# tcp/kcp/udp

### tcp和udp的区别
1. tcp面向全双工连接，udp无连接（三次握手 建立连接）
2. tcp可靠，udp不可靠（应答和重传机制 保证可靠性）
3. tcp保证顺序，udp不保证
4. tcp面向字节流，udp面向报文（tcp无保护消息边界，会粘包）
5. tcp只能一对一，udp可以一对一、一对多、多对多（tcp需要三次握手建立连接，所以不能对多）
6. tcp头部开销大，udp头部开销小
7. tcp慢，udp快

KCP协议就是在保留UDP快的基础上，提供可靠的传输，应用层使用更加简单——TCP可靠简单，但是复杂无私，所以速度慢。KCP尽可能保留UDP快的特点下，保证可靠。
* TCP是为流量设计的（每秒内可以传输多少KB的数据），讲究的是充分利用带宽。
* KCP是为流速设计的（单个数据包从一端发送到一端需要多少时间），以10%-20%带宽浪费的代价换取了比 TCP快30%-40%的传输速度。

### tcp和kcp的区别
1. tcp的超时时间是RTO*2，kcp是RTO*1.5
2. tcp重传所有数据，kcp只重传丢失的数据
3. kcp的快速重传：2次ack跨越会直接重传
4. tcp延迟ACK，kcp非延迟ACK
5. tcp使用UNA，kcp使用UNA+ACK
6. kcp正常模式和tcp一样使用公平退让法则，kcp快速模式可以关闭流控（非退让）

粘包：
举个例子：有三个数据包，大小分别为2k、4k、6k，如果采用UDP发送的话，不管接受方的接收缓存有多大，我们必须要进行至少三次以上的发送才能把数据包发送完，但是使用TCP协议发送的话，我们只需要接受方的接收缓存有12k的大小，就可以一次把这3个数据包全部发送完毕，那么就会造成接收方一次会接收不止一条消息，这就是粘包。

UNA（此编号前所有包已收到，如TCP）和ACK（该编号包已收到）

---

流量控制
滑动窗口
停止等待协议（相当于发送窗口和接收窗口大小为1）
后退N帧协议（GBN协议）
选择重传协议(SR)

消息保护边界
(1)发送固定长度的消息
(2)把消息的尺寸与消息一块发送
(3)使用特殊标记来区分消息间隔
